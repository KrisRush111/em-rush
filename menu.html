<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raccoon Clicker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .progress-bar {
            height: 20px;
            transition: width 0.3s ease;
        }
        .shop-item {
            transition: all 0.2s ease;
        }
        .shop-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .click-effect {
            position: absolute;
            pointer-events: none;
            animation: float-up 1s forwards;
            opacity: 0.8;
        }
        @keyframes float-up {
            0% {
                transform: translateY(0);
                opacity: 0.8;
            }
            100% {
                transform: translateY(-50px);
                opacity: 0;
            }
        }
        .raccoon-img {
            transition: all 0.3s ease;
            cursor: pointer;
            max-width: 100%;
            max-height: 60vh;
            object-fit: contain;
            filter: drop-shadow(0 10px 15px rgba(0, 0, 0, 0.2));
        }
        .raccoon-img:active {
            transform: scale(0.95);
        }
        .currency-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%23f59e0b" d="M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8 s8,3.59,8,8S16.41,20,12,20z M12,6c-3.31,0-6,2.69-6,6s2.69,6,6,6s6-2.69,6-6S15.31,6,12,6z M12,16c-2.21,0-4-1.79-4-4 s1.79-4,4-4s4,1.79,4,4S14.21,16,12,16z"/><path fill="%23f59e0b" d="M12,10c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S13.1,10,12,10z"/></svg>');
            background-size: contain;
            margin-right: 4px;
        }
        
        /* Анимация прыжка */
        @keyframes jump {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-20px);
            }
        }
        
        .jump-animation {
            animation: jump 0.5s ease;
        }
        
        /* Загита от копирования */
        body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }
        
        /* Защита от контекстного меню */
        body {
            pointer-events: auto;
        }
        
        /* Защита от перетаскивания изображений */
        img {
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
        }
        
        /* Тень под енотом */
        .raccoon-shadow {
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 20px;
            background: radial-gradient(ellipse at center, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0) 70%);
            border-radius: 50%;
            z-index: -1;
        }
        
        /* Анимация тени при клике */
        .raccoon-shadow:active {
            transform: translateX(-50%) scale(0.9);
        }
        
        /* Эффект пульсации для мультитач */
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }
        
        .touch-point {
            position: absolute;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            pointer-events: none;
            z-index: 100;
            animation: pulse 0.5s ease-out forwards;
        }
        
        /* Оффлайн прогресс */
        .offline-progress {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            z-index: 1000;
            display: none;
        }
        
        /* Футер с навигацией */
        .nav-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }
        
        .nav-item {
            transition: all 0.2s ease;
        }
        
        .nav-item:hover {
            transform: translateY(-5px);
        }
        
        .nav-item.active {
            color: #3B82F6;
        }
    </style>
</head>
<body class="bg-white min-h-screen flex flex-col" oncontextmenu="return false;">
    <!-- Оффлайн прогресс -->
    <div id="offline-progress" class="offline-progress">
        <div class="flex items-center">
            <i class="fas fa-clock mr-2"></i>
            <span id="offline-time">0</span> секунд оффлайн
        </div>
        <div class="mt-1">
            Получено <span id="offline-earned">0</span> RCC
        </div>
    </div>

    <!-- Основной контейнер игры -->
    <div id="game-container" class="container mx-auto px-4 py-8 flex-grow mb-16">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Основная игровая область -->
            <div class="flex-1">
                <div class="bg-gray-50 rounded-xl p-6 shadow-sm">
                    <div class="flex justify-between items-center mb-6">
                        <div class="bg-blue-100 text-blue-800 px-4 py-2 rounded-full font-semibold">
                            <span class="currency-icon"></span>
                            <span id="coins">0</span> RCC
                        </div>
                        <div class="bg-green-100 text-green-800 px-4 py-2 rounded-full font-semibold">
                            <i class="fas fa-bolt mr-2"></i>
                            <span id="cps">0</span> RCC/15 сек
                        </div>
                    </div>

                    <div class="relative flex justify-center mb-6 min-h-[300px]">
                        <div id="raccoon-container" class="relative flex items-center justify-center">
                            <img id="raccoon" src="https://i.imgur.com/JQ9wX7a.jpg" alt="Енот" class="raccoon-img">
                            <div class="raccoon-shadow"></div>
                        </div>
                    </div>

                    <div class="mb-6">
                        <div class="flex justify-between mb-1">
                            <span class="text-sm font-medium text-gray-700">Прогресс до следующего уровня</span>
                            <span class="text-sm font-medium text-gray-700"><span id="current-progress">0</span>/<span id="target">10000</span> RCC</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-4">
                            <div id="progress-bar" class="progress-bar bg-blue-500 rounded-full h-4" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 text-yellow-500">
                                <i class="fas fa-info-circle text-xl"></i>
                            </div>
                            <div class="ml-3">
                                <h3 class="text-sm font-medium text-yellow-800">Совет</h3>
                                <div class="mt-1 text-sm text-yellow-700">
                                    <p>Кликайте на енота, чтобы собирать RCC! В магазине можно купить улучшения.</p>
                                    <p class="mt-1">RCC будут начисляться даже когда игра закрыта!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Магазин -->
            <div class="lg:w-80">
                <div class="bg-gray-50 rounded-xl p-6 shadow-sm sticky top-4">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                        <i class="fas fa-store mr-3 text-blue-500"></i> Магазин
                    </h2>

                    <div class="space-y-4">
                        <!-- Улучшение клика -->
                        <div class="shop-item bg-white p-4 rounded-lg border border-gray-200">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 bg-blue-100 p-3 rounded-lg">
                                    <i class="fas fa-hand-pointer text-blue-600 text-xl"></i>
                                </div>
                                <div class="ml-4 flex-1">
                                    <h3 class="text-sm font-medium text-gray-800">Улучшенный клик</h3>
                                    <p class="mt-1 text-xs text-gray-500">+2 RCC за каждый клик</p>
                                    <div class="mt-3 flex justify-between items-center">
                                        <span class="text-sm font-semibold text-blue-600"><span id="click-power">1</span> → <span id="next-click-power">3</span> RCC</span>
                                        <button onclick="buyUpgrade('click')" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-full text-xs font-medium transition">
                                            <span id="click-price">100</span> RCC
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Пассивный доход -->
                        <div class="shop-item bg-white p-4 rounded-lg border border-gray-200">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 bg-green-100 p-3 rounded-lg">
                                    <i class="fas fa-clock text-green-600 text-xl"></i>
                                </div>
                                <div class="ml-4 flex-1">
                                    <h3 class="text-sm font-medium text-gray-800">Пассивный сбор</h3>
                                    <p class="mt-1 text-xs text-gray-500">+2 RCC каждые 15 секунд</p>
                                    <div class="mt-3 flex justify-between items-center">
                                        <span class="text-sm font-semibold text-green-600"><span id="cps-level">0</span> → <span id="next-cps-level">2</span> RCC/15 сек</span>
                                        <button onclick="buyUpgrade('cps')" class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-full text-xs font-medium transition">
                                            <span id="cps-price">250</span> RCC
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Улучшение пассивного дохода -->
                        <div class="shop-item bg-white p-4 rounded-lg border border-gray-200">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 bg-purple-100 p-3 rounded-lg">
                                    <i class="fas fa-tachometer-alt text-purple-600 text-xl"></i>
                                </div>
                                <div class="ml-4 flex-1">
                                    <h3 class="text-sm font-medium text-gray-800">Улучшенный пассив</h3>
                                    <p class="mt-1 text-xs text-gray-500">Увеличивает пассивный доход на 50%</p>
                                    <div class="mt-3 flex justify-between items-center">
                                        <span class="text-sm font-semibold text-purple-600">×1 → ×1.5</span>
                                        <button onclick="buyUpgrade('cpsMultiplier')" class="bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 rounded-full text-xs font-medium transition">
                                            <span id="cps-multiplier-price">1000</span> RCC
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Автокликер -->
                        <div class="shop-item bg-white p-4 rounded-lg border border-gray-200">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 bg-red-100 p-3 rounded-lg">
                                    <i class="fas fa-robot text-red-600 text-xl"></i>
                                </div>
                                <div class="ml-4 flex-1">
                                    <h3 class="text-sm font-medium text-gray-800">Автокликер</h3>
                                    <p class="mt-1 text-xs text-gray-500">Автоматически кликает 1 раз в секунду</p>
                                    <div class="mt-3 flex justify-between items-center">
                                        <span class="text-sm font-semibold text-red-600">0 → 1</span>
                                        <button onclick="buyUpgrade('autoClicker')" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-full text-xs font-medium transition">
                                            <span id="auto-clicker-price">5000</span> RCC
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Футер с навигацией -->
    <footer class="nav-footer">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-around">
                <!-- Меню -->
                <a href="menu.html" class="nav-item flex flex-col items-center text-gray-600 hover:text-blue-500">
                    <i class="fas fa-bars text-2xl mb-1"></i>
                    <span class="text-xs">Меню</span>
                </a>
                                
                <!-- Бизнес -->
                <a href="bissnes.html" class="nav-item flex flex-col items-center text-gray-600 hover:text-green-500">
                    <i class="fas fa-business-time text-2xl mb-1"></i>
                    <span class="text-xs">Бизнес</span>
                </a>
                                
                <!-- Достижения -->
                <a href="achievements.html" class="nav-item flex flex-col items-center text-gray-600 hover:text-yellow-500">
                    <i class="fas fa-trophy text-2xl mb-1"></i>
                    <span class="text-xs">Достижения</span>
                </a>
                                
                <!-- Настройки -->
                <a href="settings.html" class="nav-item flex flex-col items-center text-gray-600 hover:text-purple-500">
                    <i class="fas fa-cog text-2xl mb-1"></i>
                    <span class="text-xs">Настройки</span>
                </a>
            </div>
        </div>
    </footer>

    <script>
        // Глобальные переменные игры
        let coins = 0;
        let clickPower = 1;
        let cps = 0;
        let cpsLevel = 0;
        let cpsMultiplier = 1;
        let autoClickers = 0;
        let currentTarget = 10000;
        let currentLevel = 1;
        let activeTouches = {};
        let lastSaveTime = Date.now();

        // Интервал пассивного дохода (15 секунд)
        const PASSIVE_INTERVAL = 15000;

        // Цены улучшений
        const upgrades = {
            click: { basePrice: 100, price: 100, power: 2 },
            cps: { basePrice: 250, price: 250, power: 2 },
            cpsMultiplier: { basePrice: 1000, price: 1000, multiplier: 1.5 },
            autoClicker: { basePrice: 5000, price: 5000 }
        };

        // Изображения енотов для разных уровней
        const raccoonImages = [
            'raccoon.jpg', // Уровень 1
            'raccoon2.jpg',  // Уровень 2
            'raccoon3.jpg',  // Уровень 3
            'raccoon4.jpg',  // Уровень 4
            'raccoon5.jpg'   // Уровень 5
        ];

        // Инициализация игры
        function initGame() {
            updateUI();
            startPassiveIncome();
            startAutoClickers();

            // Клик по еноту (мышь)
            document.getElementById('raccoon-container').addEventListener('click', function(e) {
                handleClick(e.clientX, e.clientY);
            });

            // Мультитач для мобильных устройств
            const raccoonContainer = document.getElementById('raccoon-container');
                        
            raccoonContainer.addEventListener('touchstart', function(e) {
                e.preventDefault();
                const touches = e.changedTouches;
                                
                for (let i = 0; i < touches.length; i++) {
                    const touch = touches[i];
                    activeTouches[touch.identifier] = touch;
                                        
                    // Создаем визуальный эффект касания
                    createTouchEffect(touch.clientX, touch.clientY);
                                        
                    // Добавляем монеты за касание
                    handleClick(touch.clientX, touch.clientY);
                }
            });

            raccoonContainer.addEventListener('touchmove', function(e) {
                e.preventDefault();
                const touches = e.changedTouches;
                                
                for (let i = 0; i < touches.length; i++) {
                    const touch = touches[i];
                    activeTouches[touch.identifier] = touch;
                }
            });

            raccoonContainer.addEventListener('touchend', function(e) {
                e.preventDefault();
                const touches = e.changedTouches;
                                
                for (let i = 0; i < touches.length; i++) {
                    const touch = touches[i];
                    delete activeTouches[touch.identifier];
                }
            });

            // Защита от копирования через JavaScript
            document.addEventListener('copy', function(e) {
                e.preventDefault();
                showNotification('Копирование запрещено!');
            });

            document.addEventListener('cut', function(e) {
                e.preventDefault();
                showNotification('Вырезание запрещено!');
            });

            document.addEventListener('dragstart', function(e) {
                e.preventDefault();
            });
        }

        // Создать визуальный эффект касания
        function createTouchEffect(x, y) {
            const touchEffect = document.createElement('div');
            touchEffect.className = 'touch-point';
            touchEffect.style.left = `${x - 20}px`;
            touchEffect.style.top = `${y - 20}px`;
            document.body.appendChild(touchEffect);
                        
            // Удаляем эффект после анимации
            setTimeout(() => {
                touchEffect.remove();
            }, 500);
        }

        // Обработка клика/касания
        function handleClick(x, y) {
            addCoins(clickPower);
                        
            // Анимация прыжка
            const raccoon = document.getElementById('raccoon');
            raccoon.classList.add('jump-animation');

            // Удаляем класс анимации после завершения
            setTimeout(() => {
                raccoon.classList.remove('jump-animation');
            }, 500);

            // Создаем эффект клика
            const clickEffect = document.createElement('div');
            clickEffect.className = 'click-effect text-blue-500 font-bold';
            clickEffect.textContent = `+${clickPower} RCC`;
            clickEffect.style.left = `${x - 20}px`;
            clickEffect.style.top = `${y - 20}px`;
            document.body.appendChild(clickEffect);

            // Удаляем эффект после анимации
            setTimeout(() => {
                clickEffect.remove();
            }, 1000);
        }

        // Показать уведомление
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-exclamation-circle mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        // Добавление RCC
        function addCoins(amount) {
            coins += amount;
            updateUI();
            checkLevelUp();
            saveGame();
        }

        // Проверка повышения уровня
        function checkLevelUp() {
            if (coins >= currentTarget) {
                currentLevel++;
                currentTarget = Math.floor(currentTarget * 2.5); // Увеличиваем цель в 2.5 раза
                                
                // Меняем картинку енота (если есть следующая)
                const raccoon = document.getElementById('raccoon');
                if (currentLevel - 1 < raccoonImages.length) {
                    raccoon.src = raccoonImages[currentLevel - 1];
                                        
                    // Добавляем анимацию смены картинки
                    raccoon.style.opacity = '0';
                    setTimeout(() => {
                        raccoon.style.opacity = '1';
                    }, 300);
                }
                                
                // Обновляем UI
                updateUI();
                                
                // Показываем уведомление
                showLevelUpNotification();
            }
        }

        // Показать уведомление о повышении уровня
        function showLevelUpNotification() {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 bg-blue-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-bounce';
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-trophy mr-2 text-yellow-300"></i>
                    <span>Уровень ${currentLevel} достигнут! Новая цель: ${currentTarget} RCC</span>
                </div>
            `;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Пассивный доход (теперь каждые 15 секунд)
        function startPassiveIncome() {
            setInterval(() => {
                if (cps > 0) {
                    addCoins(cps * cpsMultiplier);
                }
            }, PASSIVE_INTERVAL); // 15 секунд
        }

        // Автокликеры
        function startAutoClickers() {
            setInterval(() => {
                if (autoClickers > 0) {
                    for (let i = 0; i < autoClickers; i++) {
                        addCoins(clickPower);
                    }
                }
            }, 1000);
        }

        // Покупка улучшения
        function buyUpgrade(type) {
            const upgrade = upgrades[type];

            if (coins >= upgrade.price) {
                coins -= upgrade.price;

                switch (type) {
                    case 'click':
                        clickPower += upgrade.power;
                        upgrade.price = Math.floor(upgrade.price * 1.5);
                        break;
                    case 'cps':
                        cps += upgrade.power;
                        cpsLevel += upgrade.power;
                        upgrade.price = Math.floor(upgrade.price * 1.8);
                        break;
                    case 'cpsMultiplier':
                        cpsMultiplier *= upgrade.multiplier;
                        upgrade.price = Math.floor(upgrade.price * 3);
                        break;
                    case 'autoClicker':
                        autoClickers += 1;
                        upgrade.price = Math.floor(upgrade.price * 2);
                        break;
                }

                updateUI();
                saveGame();
                                
                // Анимация успешной покупки
                const button = document.querySelector(`button[onclick="buyUpgrade('${type}')"]`);
                button.classList.add('bg-green-500');
                setTimeout(() => {
                    button.classList.remove('bg-green-500');
                }, 300);
            } else {
                showNotification('Не хватает RCC!');
                                
                // Анимация ошибки
                const button = document.querySelector(`button[onclick="buyUpgrade('${type}')"]`);
                button.classList.add('bg-red-500');
                setTimeout(() => {
                    button.classList.remove('bg-red-500');
                }, 300);
            }
        }

        // Обновление интерфейса
        function updateUI() {
            // Основные показатели
            document.getElementById('coins').textContent = Math.floor(coins);
            document.getElementById('cps').textContent = (cps * cpsMultiplier).toFixed(1);
                        
            // Прогресс бар
            const progressPercent = Math.min((coins / currentTarget) * 100, 100);
            document.getElementById('progress-bar').style.width = `${progressPercent}%`;
            document.getElementById('current-progress').textContent = Math.floor(coins);
            document.getElementById('target').textContent = currentTarget;
                        
            // Магазин
            document.getElementById('click-power').textContent = clickPower;
            document.getElementById('next-click-power').textContent = clickPower + upgrades.click.power;
            document.getElementById('click-price').textContent = upgrades.click.price;
                        
            document.getElementById('cps-level').textContent = cps;
            document.getElementById('next-cps-level').textContent = cps + upgrades.cps.power;
            document.getElementById('cps-price').textContent = upgrades.cps.price;
                        
            document.getElementById('cps-multiplier-price').textContent = upgrades.cpsMultiplier.price;
                        
            document.getElementById('auto-clicker-price').textContent = upgrades.autoClicker.price;
        }

        // Сохранение игры
        function saveGame() {
            const gameData = {
                coins,
                clickPower,
                cps,
                cpsLevel,
                cpsMultiplier,
                autoClickers,
                currentTarget,
                currentLevel,
                lastSaveTime: Date.now(),
                upgrades: {
                    click: { price: upgrades.click.price },
                    cps: { price: upgrades.cps.price },
                    cpsMultiplier: { price: upgrades.cpsMultiplier.price },
                    autoClicker: { price: upgrades.autoClicker.price }
                }
            };
                        
            // Сохраняем в localStorage
            localStorage.setItem('raccoonClicker', JSON.stringify(gameData));
        }

        // Загрузка игры
        function loadGame() {
            const savedData = localStorage.getItem('raccoonClicker');
            if (savedData) {
                const gameData = JSON.parse(savedData);
                coins = gameData.coins || 0;
                clickPower = gameData.clickPower || 1;
                cps = gameData.cps || 0;
                cpsLevel = gameData.cpsLevel || 0;
                cpsMultiplier = gameData.cpsMultiplier || 1;
                autoClickers = gameData.autoClickers || 0;
                currentTarget = gameData.currentTarget || 10000;
                currentLevel = gameData.currentLevel || 1;
                lastSaveTime = gameData.lastSaveTime || Date.now();
                                
                // Восстанавливаем цены улучшений
                if (gameData.upgrades) {
                    upgrades.click.price = gameData.upgrades.click.price || upgrades.click.basePrice;
                    upgrades.cps.price = gameData.upgrades.cps.price || upgrades.cps.basePrice;
                    upgrades.cpsMultiplier.price = gameData.upgrades.cpsMultiplier.price || upgrades.cpsMultiplier.basePrice;
                    upgrades.autoClicker.price = gameData.upgrades.autoClicker.price || upgrades.autoClicker.basePrice;
                }
                                
                // Устанавливаем правильное изображение енота для текущего уровня
                const raccoon = document.getElementById('raccoon');
                if (currentLevel - 1 < raccoonImages.length) {
                    raccoon.src = raccoonImages[currentLevel - 1];
                }
                                
                // Проверяем оффлайн прогресс
                checkOfflineProgress(gameData.lastSaveTime);
            }
                        
            // Инициализируем игру
            initGame();
            updateUI();
        }
                
        // Проверка оффлайн прогресса
        function checkOfflineProgress(lastSave) {
            const now = Date.now();
            const offlineTime = Math.floor((now - lastSave) / 1000); // В секундах
                        
            if (offlineTime > 5) { // Показываем только если оффлайн был больше 5 секунд
                // Максимальное время оффлайн прогресса - 24 часа
                const maxOfflineTime = 24 * 60 * 60; // 24 часа в секундах
                const actualOfflineTime = Math.min(offlineTime, maxOfflineTime);
                                
                // Рассчитываем заработанные RCC (теперь каждые 15 секунд)
                const earnedRCC = Math.floor(cps * cpsMultiplier * (actualOfflineTime / 15));
                                
                if (earnedRCC > 0) {
                    // Добавляем заработанные RCC
                    addCoins(earnedRCC);
                                        
                    // Показываем уведомление об оффлайн прогрессе
                    const offlineProgress = document.getElementById('offline-progress');
                    document.getElementById('offline-time').textContent = formatTime(actualOfflineTime);
                    document.getElementById('offline-earned').textContent = earnedRCC;
                    offlineProgress.style.display = 'block';
                                        
                    // Скрываем через 5 секунд
                    setTimeout(() => {
                        offlineProgress.style.display = 'none';
                    }, 5000);
                }
            }
        }
                
        // Форматирование времени для оффлайн прогресса
        function formatTime(seconds) {
            if (seconds < 60) {
                return `${seconds} секунд`;
            } else if (seconds < 3600) {
                const minutes = Math.floor(seconds / 60);
                return `${minutes} минут`;
            } else {
                const hours = Math.floor(seconds / 3600);
                return `${hours} часов`;
            }
        }

        // Автоматическое сохранение каждые 30 секунд
        setInterval(() => {
            saveGame();
        }, 30000);

        // Инициализация при загрузке страницы
        window.onload = function() {
            // Загружаем данные игры
            loadGame();
        };

        // Сохраняем игру при закрытии вкладка
        window.addEventListener('beforeunload', function(e) {
            saveGame();
        });
                
        // Обработчик видимости страницы
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'visible') {
                // Страница снова стала видимой - проверяем оффлайн прогресс
                const savedData = localStorage.getItem('raccoonClicker');
                if (savedData) {
                    const gameData = JSON.parse(savedData);
                    checkOfflineProgress(gameData.lastSaveTime);
                }
            } else {
                // Страница стала невидимой - сохраняем игру
                saveGame();
            }
        });
    </script>
</body>
</html>